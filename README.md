# 箱入り娘パズル Webアプリケーション 🧩

**A*アルゴリズムを使用した箱入り娘パズル解決システム**

## 🎯 概要

箱入り娘（Hakoiri Musume）は日本の伝統的なスライディングパズルです。このWebアプリケーションは、**A*アルゴリズム**を使って任意の初期配置から最短手数での解法を自動で見つけ、リアルタイム進捗表示と共に**1手順ずつ視覚的に解法プロセスを確認**できるWEBアプリです。
![](/image/hakoiri.png)

## ✨ 主な機能・特徴

### 🖱️ 高度なUI操作
- **ドラッグ&ドロップ**: 既存ピースをマウスで直感的に移動
- **クリック配置**: ピース選択パネルからクリックで新規配置
- **形状ベース選択**: 箱入り娘、横ブロック、縦ブロック、小ブロックを自動管理
- **配置制限**: 各ピースタイプの最大数を自動チェック

### 🎯 A*アルゴリズム解法
- **最適解保証**: A*アルゴリズムによる最短手数での解決
- **高度なヒューリスティック**: マンハッタン距離 + 経路障害物評価
- **効率的探索**: 重複状態排除による高速化

### 📊 リアルタイム進捗表示
- **Server-Sent Events**: リアルタイム進捗更新
- **詳細統計**: 探索件数、現在手数、推定残り手数
- **経過時間**: 探索開始からの経過時間表示
- **中止機能**: 探索中の任意タイミングでの中止

### 📺 ステップバイステップ解法表示
- **完全な解法パス**: 初期状態からゴールまでの全手順
- **ナビゲーション**: 前/次ボタンで自由な手順確認
- **視覚的フィードバック**: 各手順での盤面状態を明確表示

## 🧩 パズルピース詳細

| ピース | サイズ | 説明 | 色 | 最大数 |
|--------|--------|------|-----|-------|
| **箱入り娘 (MP)** | 2×2 | メインピース・ゴール対象 | 🔴 赤色 | 1 |
| **横ブロック (H1-H4)** | 2×1 | 横長ブロック | 🔵 青色系 | 4 |
| **縦ブロック (V1-V4)** | 1×2 | 縦長ブロック | 🟢 緑色系 | 4 |
| **小ブロック (S1-S4)** | 1×1 | 小さなブロック | 🟡 黄色系 | 4 |

**🎯 目標**: 赤い箱入り娘（MP）を盤面下部の中央位置（3行目以降、1-2列目）に移動

## 🚀 実行方法

### 1. 環境準備
```bash
pip install -r requirements.txt
```

### 2. アプリケーション起動
```bash
python app.py
```

### 3. ブラウザでアクセス
```
http://localhost:5000
```

## 📖 詳細使い方ガイド

### Phase 1: パズル配置設定
1. **ピース選択**: 右側パネルから配置したいピースタイプをクリック
2. **配置方法**: 
   - **新規配置**: 選択したピースタイプで空いているセルをクリック
   - **移動**: 既存ピースをドラッグ&ドロップ
   - **削除**: 「空」を選択してピースをクリック
3. **盤面リセット**: 「盤面リセット」ボタンで全てクリア

### Phase 2: 自動解法実行
1. **探索開始**: 「探索開始」ボタンをクリック
2. **進捗監視**: リアルタイム統計で探索状況を確認
   - 探索件数: 調査済み盤面数
   - 現在手数: 探索中の手順数
   - 推定残り: ヒューリスティックによる推定
3. **中止機能**: 必要に応じて「中止」ボタンで探索停止

### Phase 3: 解法確認
1. **ステップナビゲーション**: 前/次ボタンで手順を確認
2. **完全な解法パス**: 初期状態からゴールまでの最短経路
3. **手順カウンター**: 現在位置と総手数の表示

## 🔧 技術仕様

### バックエンド
- **フレームワーク**: Flask (Python)
- **アルゴリズム**: A*探索アルゴリズム
- **並行処理**: threading によるバックグラウンド解法
- **通信**: Server-Sent Events による進捗配信

### フロントエンド
- **UI**: HTML5, CSS3, Vanilla JavaScript
- **レスポンシブ**: モバイル対応デザイン
- **リアルタイム**: EventSource による進捗受信
- **インタラクション**: ドラッグ&ドロップ + クリック操作

### 最適化技術
- **ヒューリスティック関数**: マンハッタン距離 + 障害物評価
- **状態管理**: ハッシュベースの重複排除
- **メモリ効率**: 最小限の状態保持


